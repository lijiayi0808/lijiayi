function [pri_e_31,pri_e_32,Obj_MG3]=Fun_MG3(pri_e_13,pri_e_23,lambda_e_31,lambda_e_32)
%微网3(MG3)的分布式优化迭代模型
%% 决策变量初始化
pri_e_31=sdpvar(1,24); %微网3向微网1交互的电价
pri_e_32=sdpvar(1,24); %微网3向微网2交互的电价

%% 导入电/热负荷和电网购电电价
pri_e=[0.4711*ones(1,8),0.8759*ones(1,6),1.0947*ones(1,3),0.8759*ones(1,2),1.0947*ones(1,3),0.8759*ones(1,2)];
P_e_31=[123.780722666667	122.560837333334	120.871765333334	123.311536000000	123.593048000000	120.895508000001	81.5922283333335	86.5656070000003	-122.119388879311	-84.8762319407852	-160.582011333333	-109.222032666668	-144.461270833333	-137.174978592937	-83.8338423807197	-7.26383171405283	115.564261606104	49.6768517835378	18.5887816558369	49.4775037327626	53.2690245228859	84.1365159052281	148.096417080036	147.855931128364];
P_e_32=[97.3356876814053	96.1158023480719	94.4267303480730	96.8665010147386	97.1480130147387	96.2096396814054	94.1452183480729	123.804465333333	108.735367615905	9.94759830064140e-14	-10.3221066666667	-7.69466133333340	-9.85292000000000	-12.9495520000001	21.3851259052277	18.1946565718945	107.306576272770	45.9233584502043	6.57760298917010	38.2170237327625	43.5099418562193	76.6295292385614	138.337334413369	137.468540461697];
%% 约束条件
C=[];
for t=1:24
    C=[C,
       pri_e(t)>=pri_e_31(t)>=0.2,
       pri_e(t)>=pri_e_32(t)>=0.2,
      ];
end
C=[C,-2500<=-1700+sum(pri_e_31.*P_e_31+pri_e_32.*P_e_32),];
%% 目标函数
C_trade=sum(pri_e_31.*P_e_31+pri_e_32.*P_e_32);
Obj=-1.030*log(800+C_trade)...
    +0.5*1e1*(norm(pri_e_31-pri_e_13)^2)+sum(lambda_e_31.*(pri_e_31-pri_e_13))...
    +0.5*1e1*(norm(pri_e_32-pri_e_23)^2)+sum(lambda_e_32.*(pri_e_32-pri_e_23));    
%% 求解器配置与求解
ops=sdpsettings('solver','mosek','verbose',0,'usex0',0);
result=solvesdp(C,Obj,ops);
%% 数据输出
pri_e_31=double(pri_e_31);
pri_e_32=double(pri_e_32);
Obj_MG3=double(C_trade);
end