function [pri_e_12,pri_e_13,Obj_MG1]=Fun_MG1(pri_e_21,pri_e_31,lambda_e_12,lambda_e_13)
%微网1(MG1)的分布式优化迭代模型
%% 决策变量初始化
pri_e_12=sdpvar(1,24); %微网1向微网2交互的电价
pri_e_13=sdpvar(1,24); %微网1向微网3交互的电价

%% 导入电/热负荷和电网购电电价
pri_e=[0.4711*ones(1,8),0.8759*ones(1,6),1.0947*ones(1,3),0.8759*ones(1,2),1.0947*ones(1,3),0.8759*ones(1,2)];
P_e_12=[-16.9358683185944	-16.9358683185944	-16.9358683185944	-16.9358683185944	-16.9358683185943	-16.6858683185943	-10.6968518582764	8.32401649521588	268.354756495216	90.0087319407845	155.395855231416	106.659749263021	138.052348198598	145.915447407706	142.218951958804	62.4584719551662	-8.25768533333330	-3.75349333333340	-12.0111786666668	-11.2604800000001	-9.75908266666670	-7.50698666666670	-9.75908266666670	-5.25489066666670];
P_e_13=[-123.780722666667	-122.560837333334	-120.871765333334	-123.311536000000	-123.593048000000	-120.895508000001	-81.5922283333335	-86.5656070000003	122.119388879311	84.8762319407852	160.582011333333	109.222032666668	144.461270833333	137.174978592937	83.8338423807197	7.26383171405283	-115.564261606104	-49.6768517835378	-18.5887816558369	-49.4775037327626	-53.2690245228859	-84.1365159052281	-148.096417080036	-147.855931128364];
%% 约束条件
C=[];
for t=1:24
    C=[C,
       pri_e(t)>=pri_e_12(t)>=0.2,
       pri_e(t)>=pri_e_13(t)>=0.2,
      ];
end
C=[C,-14021<=-11645+sum(pri_e_12.*P_e_12+pri_e_13.*P_e_13),];  %  -case2 <= -子问题1 + ...
%% 目标函数
C_trade=sum(pri_e_12.*P_e_12+pri_e_13.*P_e_13);
Obj=-1.40*log(14021-11645+C_trade)...   
    +0.5*1e1*(norm(pri_e_12-pri_e_21)^2)+sum(lambda_e_12.*(pri_e_12-pri_e_21))...
    +0.5*1e1*(norm(pri_e_13-pri_e_31)^2)+sum(lambda_e_13.*(pri_e_13-pri_e_31));    
%% 求解器配置与求解
ops=sdpsettings('solver','mosek','verbose',0,'usex0',0);
result=solvesdp(C,Obj,ops);
%% 数据输出
pri_e_12=double(pri_e_12);
pri_e_13=double(pri_e_13);
Obj_MG1=double(C_trade);
end